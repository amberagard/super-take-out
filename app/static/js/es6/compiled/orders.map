{"version":3,"file":"orders.js","sources":["/Users/aagard/Documents/Code/super-take-out/app/static/js/es6/orders.es6.js"],"names":[],"mappings":"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","sourcesContent":["/* global ajax */\n/* jshint unused:false */\n\n(function() {\n    'use strict';\n\n    $(document).ready(initialize);\n\n    function initialize() {\n        $('form#order').on('change', '.menu', getMenu);\n        $('#add').click(add);\n        $('form#order').on('click', '#remove', remove);\n        $('form#order').on('change', 'input', formChanged);\n        $('form#order').on('blur', 'input', formChanged);\n        $('form#order').on('change', '.dish', formChanged);\n        $('.order').click(order);\n        $('#history').click(history);\n    }\n\n    function history() {\n        ajax('/orders/history', 'get', null, h=>{\n            console.log(h[0]);\n            $('#orderhistory').append(h);\n        });\n    }\n\n    function order() {\n        var orderItems = $('.menu-item').toArray().map(function(item) {\n            var $item = $(item);\n            var qty = $item.find('input').val() * 1;\n            var menuItem = $item.find('.dish option:selected').val();\n            return {qty:qty, item:menuItem};\n\n        });\n        ajax('/orders/', 'post', {orderItems:orderItems}, h=>{\n            window.location = '/orders';\n        });\n\n        return false;\n    }\n\n    var total = 0;\n\n    function formChanged() {\n        var item = $(this).parent();\n        updateCost(item);\n    }\n\n    function updateCost(item) {\n        updateSubTotal(item);\n        updateTotal();\n    }\n\n    function updateSubTotal(item) {\n        var subtotal = 0;\n        var qty = item.find('input').val() * 1;\n        var cost = item.find('.dish option:selected').attr('data-cost') * 1;\n        if(qty > 0 && !isNaN(cost)) {\n            subtotal = (qty * cost);\n        }\n\n        item.data('subtotal', subtotal);\n    }\n\n    function updateTotal() {\n        var subtotals = $('.menu-item').map((i,d)=>$(d).data('subtotal')).toArray();\n        var total = 0;\n\n        if(subtotals.length) {\n            total = subtotals.reduce((p,c)=>p+c);\n        }\n\n        $('#total').text('$' + total.toFixed(2));\n    }\n\n    function getMenu() {\n        var menu = $(this).val();\n        var next = $(this).next();\n        ajax(`/dishes/${menu}`, 'get', null, h=>{\n            next.empty().append(h);\n            updateCost(next.parent());\n        });\n    }\n\n    function add() {\n        var item = $('form#order > .menu-item:last-child');\n        $('form#order').append(item.clone());\n    }\n\n    function remove(e) {\n        if($('form#order > .menu-item').length > 1) {\n            $(this).parent().remove();\n            updateTotal();\n        }\n        e.preventDefault();\n    }\n\n})();\n"]}